<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Tutorial: Hello Dojo!</title>
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/dojo/1.10.2/dojo/resources/dojo.css">
</head>
<body>
    <div id="widgetContainer">
        <div id="widgetNode"></div>
        <button id="testButtonNode" type="button"></button>
        <button id="test2ButtonNode" type="button"></button>
        <button id="test3ButtonNode" type="button"></button>
        <div id="testResult">-</div>
    </div>

    <!-- load Dojo -->
    <script type="text/javascript">
        var dojoConfig = {
            async: true,
            packages: [
                {
                name: 'src',
                location: location.pathname.replace(/[^\/]+$/, '') + '../'
                },
                {
                    name: 'dojo-form-controls',
                    location: location.pathname.replace(/[^\/]+$/, '') + '../bower_components/dojo-form-controls'
                },
                {
                    name: "mijit",
                    location: location.pathname.replace(/[^\/]+$/, '') + "../bower_components/mijit"
                }
            ]
        };
    </script>
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.10.1/dojo/dojo.js"
            data-dojo-config="async: true"></script>

    <script>
        require([
            "src/CrabpyWidget",
            "dojo-form-controls/Button",
            "dojo/dom",
            "dojo/json"
        ], function (CrabpyWidget, Button, dom, JSON) {
            // init widget
            var widgetUnderTest = new CrabpyWidget({
                name: "location",
                baseUrl: "https://dev-geo.onroerenderfgoed.be"
            }, 'widgetNode');
            widgetUnderTest.startup();

            var myButton = new Button({
                label: "Get value",
                onClick: function(){
                    // Do something:
                    dom.byId("testResult").innerHTML = JSON.stringify(widgetUnderTest.get('value'));
                }
            }, "testButtonNode").startup();

            var myButton2 = new Button({
                label: "Set value",
                onClick: function(){
                    widgetUnderTest.set('value', {"province":{"id":"10000","name":"Antwerpen"},"municipality":{"id":"44","name":"Arendonk"},"street":{"id":"12417","name":"Aartrijtstraat"},"housenumber":{"id":"537126","name":"6"}});
//                    widgetUnderTest.set('value', {"municipality":{"id":"44","name":"Arendonk"},"street":{"id":"12417","name":"Aartrijtstraat"},"housenumber":{"id":"537126","name":"6"}});
//                    widgetUnderTest.set('value', {"province":{"id":"10000","name":"Antwerpen"}});
                }
            }, "test2ButtonNode").startup();

            var myButton3 = new Button({
                label: "reset",
                onClick: function(){
                    widgetUnderTest.reset();
                    dom.byId("testResult").innerHTML = JSON.stringify(widgetUnderTest.get('value'));
                }
            }, "test3ButtonNode").startup();
        });
    </script>
</body>
</html>