<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test crabpy widget</title>
</head>
<body>
    <div id="widgetContainer">
        <div id="widgetNode"></div>
        <button id="testButtonNode" type="button"></button>
        <button id="test2ButtonNode" type="button"></button>
        <button id="test3ButtonNode" type="button"></button>
        <button id="test4ButtonNode" type="button"></button>
        <div id="testResult">-</div>
        <div id="bboxResult">-</div>
        <hr>
        <div id="widgetNodeB"></div>
        <button id="testBButtonNode" type="button"></button>
        <button id="testB2ButtonNode" type="button"></button>
        <button id="testB3ButtonNode" type="button"></button>
        <button id="testB4ButtonNode" type="button"></button>
        <div id="testBResult">-</div>
        <div id="bboxBResult">-</div>
    </div>

    <!-- load Dojo -->
    <script type="text/javascript">
        var dojoConfig = {
            async: true,
            packages: [
                {
                name: 'src',
                location: location.pathname.replace(/[^\/]+$/, '') + '../'
                },
                {
                    name: 'dojo-form-controls',
                    location: location.pathname.replace(/[^\/]+$/, '') + '../bower_components/dojo-form-controls'
                },
                {
                    name: "mijit",
                    location: location.pathname.replace(/[^\/]+$/, '') + "../bower_components/mijit"
                }
            ]
        };
    </script>
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.10.2/dojo/dojo.js"
            data-dojo-config="async: true"></script>

    <script>
        require([
            "src/CrabpyWidget",
            "dojo-form-controls/Button",
            "dojo/dom",
            "dojo/json"
        ], function (CrabpyWidget, Button, dom, JSON) {
            // init widget
            var crabpyWidget = new CrabpyWidget({
                name: "location",
                baseUrl: "https://dev-geo.onroerenderfgoed.be"
                // baseUrl: "http://localhost:6543"
            });

            var crabZoomer = crabpyWidget.createCrabZoomer('widgetNode');
            crabZoomer.startup();

            new Button({
                label: "Get value",
                onClick: function(){
                    // Do something:
                    dom.byId("testResult").innerHTML = JSON.stringify(crabZoomer.get('value'));
                }
            }, "testButtonNode").startup();

            new Button({
                label: "Set value",
                onClick: function(){
                    crabZoomer.set('value', {"province":{"id":"10000","name":"Antwerpen"},"municipality":{"id":"44","name":"Arendonk"},"street":{"id":"12417","name":"Aartrijtstraat"},"housenumber":{"id":"537126","name":"6"}});
//                    crabZoomer.set('value', {"municipality":{"id":"44","name":"Arendonk"},"street":{"id":"12417","name":"Aartrijtstraat"},"housenumber":{"id":"537126","name":"6"}});
//                    crabZoomer.set('value', {"province":{"id":"10000","name":"Antwerpen"}});
                }
            }, "test2ButtonNode").startup();

            new Button({
                label: "reset",
                onClick: function(){
                    crabZoomer.reset();
                    dom.byId("testResult").innerHTML = JSON.stringify(crabZoomer.get('value'));
                    dom.byId("bboxResult").innerHTML = JSON.stringify(crabZoomer.getBbox());
                }
            }, "test3ButtonNode").startup();

            new Button({
                label: "get bbox",
                onClick: function(){
                    dom.byId("bboxResult").innerHTML = crabZoomer.getBbox();
                }
            }, "test4ButtonNode").startup();


            //------------
            var capakeyZoomer = crabpyWidget.createCapakeyZoomer('widgetNodeB');
            capakeyZoomer.startup();

            new Button({
                label: "Get value",
                onClick: function(){
                    // Do something:
                    dom.byId("testBResult").innerHTML = JSON.stringify(capakeyZoomer.get('value'));
                }
            }, "testBButtonNode").startup();

            new Button({
                label: "Set value",
                onClick: function(){
                    capakeyZoomer.set('value', {"gemeente":{"id":"11001","name":"Aartselaar"},"afdeling":{"id":"11001","name":"AARTSELAAR 1 AFD"},"sectie":{"id":"B","name":"B"},"perceel":{"id":"0008/00H002","name":"11001B0008/00H002"}});
                }
            }, "testB2ButtonNode").startup();

            new Button({
                label: "reset",
                onClick: function(){
                    capakeyZoomer.reset();
                    dom.byId("testBResult").innerHTML = JSON.stringify(capakeyZoomer.get('value'));
                    dom.byId("bboxBResult").innerHTML = JSON.stringify(capakeyZoomer.getBbox());
                }
            }, "testB3ButtonNode").startup();

            new Button({
                label: "get bbox",
                onClick: function(){
                    dom.byId("bboxBResult").innerHTML = capakeyZoomer.getBbox();
                }
            }, "testB4ButtonNode").startup();
        });
    </script>
</body>
</html>